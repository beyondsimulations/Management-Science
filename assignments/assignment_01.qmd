---
title: "Assignment 1: Risk Analysis & Forecasting"
subtitle: "Management Science"
code-links:
  - text: Python
    href: assignment_01.py
    icon: hand-thumbs-up
---

## Assignment Overview

**Due:** Start of Lecture 8
**Weight:** 30% of final grade
**Expected Time:** 4-6 hours
**Work:** Groups

You're a group of junior analysts at a consulting firm. A client needs help with:

1. Understanding investment risk using simulation
2. Forecasting product demand

## Consultants
Who is part of your group?

```{python}
"""
YOUR ANSWER HERE:
"""
```

## Setup

```{python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# Sets a random seed for reproducibility (don't change this!)
np.random.seed(2025)
```

## Part A: Investment Risk Simulation (50%)

### Scenario

Your client wants to invest €100,000 in a new product launch. They need to understand the risk.

**Given Information:**

- Best case: €300,000 return (20% probability)
- Most likely: €150,000 return (60% probability)
- Worst case: €50,000 return (20% probability)
- At least 100 simulations

### Task 1: Simple Monte Carlo Simulation (15%)

Create a function that:
1. Takes the number of simulations as input
2. For each simulation, randomly selects one outcome (€300,000, €150,000, or €50,000) based on the given probabilities (20%, 60%, 20%)
3. Returns an array of all simulated returns

::: callout-tip
You could use `np.random.choice()` with the `p` parameter for probabilities.
:::

```{python}
# Create a function that runs simulations and randomly picks outcomes
# YOUR CODE HERE


# Run your simulation with at least 100 simulations
# Store results in a variable called 'simple_returns'
# YOUR CODE HERE

```

### Task 2: Add Uncertainty to Probabilities (15%)

Unfortunately, it is not as easy as assumed before and we have to simulate the investment into the product launch with uncertain probabilities. The data based on previous launches of similar products were distributed as stated below.

For each simulation, sample new probabilities:

- Best case probability: 10% to 30% (uniform distribution)
- Worst case probability: 10% to 30% (uniform distribution)
- Most likely probability: remainder to sum to 100%

::: callout-important
The probabilities must sum to 100% in each simulation. After randomly sampling the best and worst case probabilities, calculate the most likely probability based on the remaining percentage.
:::

Create a function that:

1. For each simulation, first sample random probabilities for best and worst cases
2. Calculate the most likely probability as the remainder
3. Use these probabilities to select an outcome for that simulation
4. Return an array of all simulated returns

::: callout-tip
Use `np.random.uniform(low, high)` to sample probabilities.
:::

```{python}
# Create a new function that runs simulations and picks outcomes under uncertainty
# YOUR CODE HERE

# Run simulation with uncertainty (at least 1000 simulations)
# Store results in a variable called 'uncertain_returns'
# YOUR CODE HERE

```

### Task 3: Analysis & Visualization (20%)

Use the results from Task 2 (uncertain probabilities simulation) for this analysis.

```{python}
# Create histogram of returns from uncertain_returns
# Add labels, title, and show the initial investment line (€100,000)
# YOUR CODE HERE

# Calculate key metrics from uncertain_returns:
# 1. Probability of losing money (proportion where return < €100,000)
# 2. 95% Value at Risk (5th percentile of returns - worst case in 95% scenarios)
# 3. Expected return (mean of all simulated returns)
# 4. Expected profit (expected return - initial investment of €100,000)
# YOUR CODE HERE

# Print all metrics clearly
# YOUR CODE HERE

```

**Business Question:**
Should the client make this investment? Write 3-4 sentences explaining your recommendation based on the metrics above (probability of loss, VaR, expected profit).

```{python}
"""
YOUR ANSWER HERE:
"""
```

## Part B: Demand Forecasting (50%)

### Scenario

A retail client needs to forecast demand for the next 3 months to plan inventory.

### The Data

```{python}
# DON'T CHANGE ANYTHING BELOW!
# 24 months of sales data
sales_data = {
    'month': list(range(1, 25)),
    'sales_units': [
        120, 135, 155, 145,  # Spring Year 1
        165, 180, 195, 175,  # Summer Year 1
        150, 140, 125, 130,  # Fall Year 1
        110, 105, 115, 125,  # Winter Year 1/2
        140, 150, 170, 160,  # Spring Year 2
        175, 190, 210, 185   # Summer Year 2
    ]
}

# Convert to pandas DataFrame
df = pd.DataFrame(sales_data)
print(df.head())
print(f"\nTotal months: {len(df)}")
print(f"Average sales: {df['sales_units'].mean():.1f}")
# DON'T CHANGE ANYTHING ABOVE!
```

### Task 1: Moving Average Forecast (15%)

Help the client to implement a function that calculates the moving average forecast for the next period based on a flexible window size.

**What the function should do:**

- Take historical sales data and a window size as inputs
- Calculate the average of the last N periods (where N = window size)
- Return the forecast for the next period

```{python}
# Implement a moving average forecast function
# Function should take: data (array/list) and window (int)
# Function should return: forecast for next period (float)
# YOUR CODE HERE

# Test different window sizes: 3, 6, and 12 months
# For each, calculate and print the forecast for month 25
# Use the full 24 months of data
# YOUR CODE HERE

```

### Task 2: Exponential Smoothing (15%)

You and the client both think that a simple moving average forecast might not be sufficient and you are thus tasked to test exponential smoothing, which gives more weight to recent observations while still considering historical data.

The formula is:

$$F_t = α \times A_{t-1} + (1 - α) \times F_{t-1}$$

Where:

- $F_t$ = Forecast for period $t$
- $A_{t-1}$ = Actual value in previous period
- $F_{t-1}$ = Forecast for previous period
- $α$ = Smoothing parameter between 0 and 1

**How it works:**

- Start with the first actual value as your initial forecast: $F_1 = A_1$
- For each subsequent period, update the forecast using the formula above
- Higher α (e.g., 0.7) = more weight on recent data (responsive to changes)
- Lower α (e.g., 0.1) = more weight on historical pattern (smooth, stable)

**Example with α = 0.3:**

- Month 1: Actual = 120, Forecast = 120 (initial)
- Month 2: Actual = 135, Forecast = 0.3 × 120 + 0.7 × 120 = 120
- Month 3: Actual = 155, Forecast = 0.3 × 135 + 0.7 × 120 = 124.5
- And so on...

```{python}
# Implement exponential smoothing function
# Function should take: data (array/list) and alpha (float between 0 and 1)
# Function should return: forecast for next period (float)
# Remember: Start with F_1 = A_1, then apply formula for subsequent periods
# YOUR CODE HERE

# Test different alpha values: 0.1 (smooth), 0.3 (balanced), 0.7 (responsive)
# For each, calculate and print the forecast for month 25
# Use the full 24 months of data
# YOUR CODE HERE

```

### Task 3: Evaluate and Compare Methods (20%)

Now compare the two forecasting methods using a proper train/test split.

**Approach:**

- Use first 20 months for initial training
- Forecast months 21-24 one at a time
- After each forecast, **add the actual value to your training data** before forecasting the next month!
- Calculate forecast accuracy using Mean Absolute Error (MAE)

::: callout-tip
This is called "rolling forecast".
:::

**For this task, use:**

- Moving Average with window=3
- Exponential Smoothing with alpha=0.3

```{python}
# Split data: first 20 months for training, last 4 for testing
train_data = df['sales_units'].values[:20].copy()
test_data = df['sales_units'].values[20:]

print(f"Training on months 1-20, testing on months 21-24")
print(f"Test data: {test_data}")

# Generate rolling forecasts for test period (months 21-24)
ma_forecasts = []
es_forecasts = []

# For each test month (4 iterations):
# 1. Use current training data to generate forecast
# 2. Store the forecast
# 3. Add the actual value to training data for next iteration
# YOUR CODE HERE

# Calculate Mean Absolute Error (MAE) for both methods
# MAE = average of |actual - forecast|
# YOUR CODE HERE

# Print results
# YOUR CODE HERE

```

```{python}
# Visualization: Plot actual sales with forecasts
# Create a plot showing:
# 1. All 24 months of actual sales
# 2. Forecasts for months 21-24 from both methods
# 3. Legend identifying each line
# YOUR CODE HERE

```

**Business Question:** Which forecasting method would you recommend and why? Consider the MAE values you calculated. (2-3 sentences)

```{python}
"""
YOUR ANSWER HERE:
"""
```

## Submission Checklist

- [ ] All code cells run without errors
- [ ] Functions are commented
- [ ] Visualizations are clear and labeled
- [ ] Business questions are answered
- [ ] Names added to top of notebook

## Tips

- Use AI tools to help understand concepts and program, but make sure you understand the code
- Start simple and get something working before optimizing
- Remember: the goal is good solutions, not perfect ones
