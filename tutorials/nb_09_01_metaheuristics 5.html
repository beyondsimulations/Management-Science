<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Notebook 9.1 - Metaheuristics: Beyond Local Optima – Management Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-46d4eb725d7d2b8695ccd307f5b3c105.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-197188da37a79cb9418c4f38e6d23e8d.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-46d4eb725d7d2b8695ccd307f5b3c105.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-22c5f25fcfc5fd5610dfced435a3b672.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-f088ff709e1277e0222aba4cda41ab4d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-22c5f25fcfc5fd5610dfced435a3b672.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" src="https://umi.byndsim.com/script.js" data-website-id="e230d76b-b0a6-477e-8c5d-19a7bd661e68"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lectures/lec_09_metaheuristics.html">09 Metaheuristics</a></li><li class="breadcrumb-item"><a href="../tutorials/nb_09_01_metaheuristics.html">NB-09-01 Metaheuristics</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="https://images.beyondsimulations.com/lectures/mj_laptops.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="https://images.beyondsimulations.com/lectures/mj_laptops.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">***</span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">01 Let’s Start</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_01_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Leture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_01_01_variables_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-01-02 Variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_01_02_lists_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-01-02 Lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_01_03_conditionals_while.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-01-03 Conditions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">02 Advances</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_02_copilot_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_02_01_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-02-01 Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_02_02_dictionaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-02-02 Dictionaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_02_03_sorting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-02-03 Sorting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_02_04_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-02-04 Recap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">03 Foundation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_03_closing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_03_01_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-03-01 Numpy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_03_02_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-03-02 Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_03_03_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-03-03 Plotting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">04 Monte Carlo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_04_monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_04_01_monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-04-01 Monte Carlo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_04_02_techventure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-04-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">05 Forecasting</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_05_forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_05_01_time_series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-05-01 Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_05_02_predictor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-05-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">06 Greedy Search</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_06_greedy_algorithms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_06_01_scheduling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-06-01 Scheduling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_06_02_scheduler.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-06-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">07 Local Search</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_07_local_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_07_01_local_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-07-01 Routing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_07_02_routing_competition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-07-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">08 Multi Objective</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_08_multi_objective.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_08_01_multi_objective.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-08-01 Pareto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_08_02_fleet_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-08-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">09 Metaheuristics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_09_metaheuristics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_09_01_metaheuristics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">NB-09-01 Metaheuristics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_09_02_restaurant_staffing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NB-09-02 Competition</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">10 Consulting Projects</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lec_10_consulting_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_project_01_quickbite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 01: QuickBite</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_project_02_nursenext.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 02: NurseNext</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorials/nb_project_03_techmart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project 03: TechMart</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">***</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/uv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment_00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/assignment_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 02</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/cheatsheet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cheatsheet</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/vote.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vote</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../general/literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#section-1-understanding-the-distribution-network" id="toc-section-1-understanding-the-distribution-network" class="nav-link" data-scroll-target="#section-1-understanding-the-distribution-network">Section 1: Understanding the Distribution Network</a>
  <ul class="collapse">
  <li><a href="#bean-counters-european-footprint" id="toc-bean-counters-european-footprint" class="nav-link" data-scroll-target="#bean-counters-european-footprint">Bean Counter’s European Footprint</a></li>
  <li><a href="#visualizing-the-network" id="toc-visualizing-the-network" class="nav-link" data-scroll-target="#visualizing-the-network">Visualizing the Network</a></li>
  <li><a href="#calculating-geographic-distances" id="toc-calculating-geographic-distances" class="nav-link" data-scroll-target="#calculating-geographic-distances">Calculating Geographic Distances</a></li>
  <li><a href="#exercise-1.1-implement-the-network-cost-function-with-balanced-allocation" id="toc-exercise-1.1-implement-the-network-cost-function-with-balanced-allocation" class="nav-link" data-scroll-target="#exercise-1.1-implement-the-network-cost-function-with-balanced-allocation">Exercise 1.1: Implement the Network Cost Function with Balanced Allocation</a></li>
  <li><a href="#helper-function-get-café-center-assignments" id="toc-helper-function-get-café-center-assignments" class="nav-link" data-scroll-target="#helper-function-get-café-center-assignments">Helper Function: Get Café-Center Assignments</a></li>
  <li><a href="#visualize-initial-random-solution" id="toc-visualize-initial-random-solution" class="nav-link" data-scroll-target="#visualize-initial-random-solution">Visualize Initial Random Solution</a></li>
  </ul></li>
  <li><a href="#section-2-greedy-construction---the-baseline" id="toc-section-2-greedy-construction---the-baseline" class="nav-link" data-scroll-target="#section-2-greedy-construction---the-baseline">Section 2: Greedy Construction - The Baseline</a>
  <ul class="collapse">
  <li><a href="#exercise-2.1-implement-greedy-center-selection" id="toc-exercise-2.1-implement-greedy-center-selection" class="nav-link" data-scroll-target="#exercise-2.1-implement-greedy-center-selection">Exercise 2.1: Implement Greedy Center Selection</a></li>
  <li><a href="#visualize-the-greedy-solution" id="toc-visualize-the-greedy-solution" class="nav-link" data-scroll-target="#visualize-the-greedy-solution">Visualize the Greedy Solution</a></li>
  </ul></li>
  <li><a href="#section-3-local-search" id="toc-section-3-local-search" class="nav-link" data-scroll-target="#section-3-local-search">Section 3: Local Search</a>
  <ul class="collapse">
  <li><a href="#exercise-3.1-implement-the-swap-neighborhood" id="toc-exercise-3.1-implement-the-swap-neighborhood" class="nav-link" data-scroll-target="#exercise-3.1-implement-the-swap-neighborhood">Exercise 3.1: Implement the Swap Neighborhood</a></li>
  <li><a href="#exercise-3.2-implement-local-search" id="toc-exercise-3.2-implement-local-search" class="nav-link" data-scroll-target="#exercise-3.2-implement-local-search">Exercise 3.2: Implement Local Search</a></li>
  <li><a href="#visualize-local-search-solution" id="toc-visualize-local-search-solution" class="nav-link" data-scroll-target="#visualize-local-search-solution">Visualize Local Search Solution</a></li>
  </ul></li>
  <li><a href="#section-4-simulated-annealing---escaping-local-optima" id="toc-section-4-simulated-annealing---escaping-local-optima" class="nav-link" data-scroll-target="#section-4-simulated-annealing---escaping-local-optima">Section 4: Simulated Annealing - Escaping Local Optima</a>
  <ul class="collapse">
  <li><a href="#exercise-4.1-implement-the-sa-acceptance-criterion" id="toc-exercise-4.1-implement-the-sa-acceptance-criterion" class="nav-link" data-scroll-target="#exercise-4.1-implement-the-sa-acceptance-criterion">Exercise 4.1: Implement the SA Acceptance Criterion</a></li>
  <li><a href="#exercise-4.2-implement-simulated-annealing" id="toc-exercise-4.2-implement-simulated-annealing" class="nav-link" data-scroll-target="#exercise-4.2-implement-simulated-annealing">Exercise 4.2: Implement Simulated Annealing</a></li>
  <li><a href="#visualize-sa-evolution" id="toc-visualize-sa-evolution" class="nav-link" data-scroll-target="#visualize-sa-evolution">Visualize SA Evolution</a></li>
  <li><a href="#visualize-sa-solution" id="toc-visualize-sa-solution" class="nav-link" data-scroll-target="#visualize-sa-solution">Visualize SA Solution</a></li>
  </ul></li>
  <li><a href="#section-5-ceo-decision-framework-competition-connection" id="toc-section-5-ceo-decision-framework-competition-connection" class="nav-link" data-scroll-target="#section-5-ceo-decision-framework-competition-connection">Section 5: CEO Decision Framework &amp; Competition Connection</a>
  <ul class="collapse">
  <li><a href="#the-business-case" id="toc-the-business-case" class="nav-link" data-scroll-target="#the-business-case">The Business Case</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What’s Next?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="nb_09_01_metaheuristics.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="nb_09_01_metaheuristics.ipynb" download="nb_09_01_metaheuristics.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="nb_09_01_metaheuristics.py"><i class="bi bi-hand-thumbs-up"></i>Python</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lectures/lec_09_metaheuristics.html">09 Metaheuristics</a></li><li class="breadcrumb-item"><a href="../tutorials/nb_09_01_metaheuristics.html">NB-09-01 Metaheuristics</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Notebook 9.1 - Metaheuristics: Beyond Local Optima</h1>
<p class="subtitle lead">Management Science - Bean Counter’s European Expansion</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Welcome back, CEO! Bean Counter has grown to <strong>1,000 cafés across Europe</strong>, and the Board just dropped a bombshell in your quarterly review:</p>
<p><strong>The Distribution Crisis:</strong></p>
<ul>
<li>Current network: 50 distribution centers selected <strong>randomly</strong> 10 years ago</li>
<li>Annual logistics cost: <strong>€45 million</strong> (facility leases + delivery)</li>
<li>Competitors using optimization are <strong>20% more efficient</strong></li>
<li>Board mandate: <strong>Redesign the entire network</strong> or lose market share</li>
</ul>
<p>You have 200 potential locations to choose from, and must select exactly 50 for new 10-year leases starting next quarter.</p>
<p><strong>Your mission:</strong> Use advanced optimization to save <strong>€10+ million annually</strong> and prove that Bean Counter can compete in the age of AI.</p>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>The Stakes Are High
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is NOT a routing problem with a few trucks. This is a <strong>strategic infrastructure decision</strong> worth millions over the contract period. Simple methods will find <em>good</em> solutions. But metaheuristics can potentially find <strong>great</strong> solutions worth millions more.</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>How to Use This Tutorial
</div>
</div>
<div class="callout-body-container callout-body">
<p>Work through each section in order. Write code where marked “YOUR CODE BELOW” and verify with the provided assertions. You’ll implement greedy, local search, simulated annealing, and genetic algorithms, the techniques you’ll need for the Restaurant Staffing Competition!</p>
</div>
</div>
<div id="a032653e" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Set</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed for reproducibility</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2025</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">2025</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Libraries loaded! Let's optimize Bean Counter's European distribution network."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Libraries loaded! Let's optimize Bean Counter's European distribution network.</code></pre>
</div>
</div>
</section>
<section id="section-1-understanding-the-distribution-network" class="level1">
<h1>Section 1: Understanding the Distribution Network</h1>
<p>Before we can optimize, we need to understand the scale and structure of Bean Counter’s challenge.</p>
<section id="bean-counters-european-footprint" class="level2">
<h2 class="anchored" data-anchor-id="bean-counters-european-footprint">Bean Counter’s European Footprint</h2>
<div id="43503543" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DON'T CHANGE ANYTHING BELOW</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Major European cities (simplified)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>european_cities <span class="op">=</span> {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'London'</span>: (<span class="fl">51.5074</span>, <span class="op">-</span><span class="fl">0.1278</span>, <span class="dv">120</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Paris'</span>: (<span class="fl">48.8566</span>, <span class="fl">2.3522</span>, <span class="dv">95</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Berlin'</span>: (<span class="fl">52.5200</span>, <span class="fl">13.4050</span>, <span class="dv">80</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Madrid'</span>: (<span class="fl">40.4168</span>, <span class="op">-</span><span class="fl">3.7038</span>, <span class="dv">75</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rome'</span>: (<span class="fl">41.9028</span>, <span class="fl">12.4964</span>, <span class="dv">65</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Amsterdam'</span>: (<span class="fl">52.3676</span>, <span class="fl">4.9041</span>, <span class="dv">55</span>),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Vienna'</span>: (<span class="fl">48.2082</span>, <span class="fl">16.3738</span>, <span class="dv">50</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Barcelona'</span>: (<span class="fl">41.3851</span>, <span class="fl">2.1734</span>, <span class="dv">60</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Munich'</span>: (<span class="fl">48.1351</span>, <span class="fl">11.5820</span>, <span class="dv">45</span>),</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Hamburg'</span>: (<span class="fl">53.5511</span>, <span class="fl">9.9937</span>, <span class="dv">40</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Milan'</span>: (<span class="fl">45.4642</span>, <span class="fl">9.1900</span>, <span class="dv">55</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Prague'</span>: (<span class="fl">50.0755</span>, <span class="fl">14.4378</span>, <span class="dv">35</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Brussels'</span>: (<span class="fl">50.8503</span>, <span class="fl">4.3517</span>, <span class="dv">45</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Zurich'</span>: (<span class="fl">47.3769</span>, <span class="fl">8.5417</span>, <span class="dv">40</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Copenhagen'</span>: (<span class="fl">55.6761</span>, <span class="fl">12.5683</span>, <span class="dv">35</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Stockholm'</span>: (<span class="fl">59.3293</span>, <span class="fl">18.0686</span>, <span class="dv">38</span>),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Dublin'</span>: (<span class="fl">53.3498</span>, <span class="op">-</span><span class="fl">6.2603</span>, <span class="dv">32</span>),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lyon'</span>: (<span class="fl">45.7640</span>, <span class="fl">4.8357</span>, <span class="dv">30</span>),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Manchester'</span>: (<span class="fl">53.4808</span>, <span class="op">-</span><span class="fl">2.2426</span>, <span class="dv">28</span>),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lisbon'</span>: (<span class="fl">38.7223</span>, <span class="op">-</span><span class="fl">9.1393</span>, <span class="dv">42</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_cafe_locations(cities_dict, total_cafes<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate café locations clustered around major European cities."""</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    cafes <span class="op">=</span> []</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    cities_list <span class="op">=</span> <span class="bu">list</span>(cities_dict.items())</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Distribute cafés proportionally to city size</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    total_weight <span class="op">=</span> <span class="bu">sum</span>(weight <span class="cf">for</span> _, (_, _, weight) <span class="kw">in</span> cities_list)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> city_name, (lat, lon, weight) <span class="kw">in</span> cities_list:</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Number of cafés in this city's region</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        n_cafes <span class="op">=</span> <span class="bu">int</span>(total_cafes <span class="op">*</span> weight <span class="op">/</span> total_weight)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Generate cafés with some spread around city center</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_cafes):</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Add random offset</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>            cafe_lat <span class="op">=</span> lat <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">1.2</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>            cafe_lon <span class="op">=</span> lon <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">1.4</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>            cafes.append((cafe_lat, cafe_lon))</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill remaining cafés to reach exactly 1000</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(cafes) <span class="op">&lt;</span> total_cafes:</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        city_name, (lat, lon, _) <span class="op">=</span> random.choice(cities_list)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        cafe_lat <span class="op">=</span> lat <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        cafe_lon <span class="op">=</span> lon <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        cafes.append((cafe_lat, cafe_lon))</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cafes[:total_cafes]</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate café locations</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>cafe_locations <span class="op">=</span> generate_cafe_locations(european_cities)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate potential distribution center locations</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co"># (More concentrated near major cities, but with some strategic outliers)</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>potential_centers <span class="op">=</span> []</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>cities_list <span class="op">=</span> <span class="bu">list</span>(european_cities.items())</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> city_name, (lat, lon, weight) <span class="kw">in</span> cities_list:</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># More centers near bigger cities</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    n_centers <span class="op">=</span> <span class="bu">max</span>(<span class="dv">5</span>, <span class="bu">int</span>(<span class="dv">200</span> <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(w <span class="cf">for</span> _, (_, _, w) <span class="kw">in</span> cities_list)))</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">min</span>(n_centers, <span class="dv">15</span>)):  <span class="co"># Cap per city</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>        center_lat <span class="op">=</span> lat <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">2.0</span>)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>        center_lon <span class="op">=</span> lon <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">2.0</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>        potential_centers.append((center_lat, center_lon))</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure exactly 200 potential centers</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">len</span>(potential_centers) <span class="op">&lt;</span> <span class="dv">200</span>:</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    city_name, (lat, lon, _) <span class="op">=</span> random.choice(cities_list)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    center_lat <span class="op">=</span> lat <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    center_lon <span class="op">=</span> lon <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.7</span>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    potential_centers.append((center_lat, center_lon))</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>potential_centers <span class="op">=</span> potential_centers[:<span class="dv">200</span>]</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Bean Counter's European Network:"</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • </span><span class="sc">{</span><span class="bu">len</span>(cafe_locations)<span class="sc">}</span><span class="ss"> cafés requiring daily deliveries"</span>)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • </span><span class="sc">{</span><span class="bu">len</span>(potential_centers)<span class="sc">}</span><span class="ss"> potential distribution center locations"</span>)</span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Must select exactly 50 centers for 10-year lease"</span>)</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Each center: €500,000/year facility cost"</span>)</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Each center serves exactly 20 cafés (balanced load)"</span>)</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Delivery cost: €2 per km per day"</span>)</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total annual facility budget: €25,000,000"</span>)</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Delivery costs depend on your network design!"</span>)</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co"># DON'T CHANGE ANYTHING ABOVE</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bean Counter's European Network:
  • 1000 cafés requiring daily deliveries
  • 200 potential distribution center locations
  • Must select exactly 50 centers for 10-year lease
  • Each center: €500,000/year facility cost
  • Each center serves exactly 20 cafés (balanced load)
  • Delivery cost: €2 per km per day

Total annual facility budget: €25,000,000
Delivery costs depend on your network design!</code></pre>
</div>
</div>
</section>
<section id="visualizing-the-network" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-network">Visualizing the Network</h2>
<p>Let’s see the geographic distribution of cafés and potential centers across Europe:</p>
<div id="1e8bed15" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization of Bean Counter's European network</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cafés</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>cafe_lats <span class="op">=</span> [loc[<span class="dv">0</span>] <span class="cf">for</span> loc <span class="kw">in</span> cafe_locations]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>cafe_lons <span class="op">=</span> [loc[<span class="dv">1</span>] <span class="cf">for</span> loc <span class="kw">in</span> cafe_locations]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(cafe_lons, cafe_lats, s<span class="op">=</span><span class="dv">10</span>, alpha<span class="op">=</span><span class="fl">0.4</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, label<span class="op">=</span><span class="st">'Cafés (1000)'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot potential centers</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>center_lats <span class="op">=</span> [loc[<span class="dv">0</span>] <span class="cf">for</span> loc <span class="kw">in</span> potential_centers]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>center_lons <span class="op">=</span> [loc[<span class="dv">1</span>] <span class="cf">for</span> loc <span class="kw">in</span> potential_centers]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>plt.scatter(center_lons, center_lats, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Potential Centers (200)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Bean Counter's European Network: 1000 Cafés &amp; 200 Potential Distribution Centers"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="nb_09_01_metaheuristics_files/figure-html/cell-4-output-1.png" width="1335" height="950" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice how cafés cluster around major European cities! This will be important for our optimization.</p>
</section>
<section id="calculating-geographic-distances" class="level2">
<h2 class="anchored" data-anchor-id="calculating-geographic-distances">Calculating Geographic Distances</h2>
<p>We’ll use the Haversine formula to calculate real distances between geographic coordinates.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>The Haversine Formula
</div>
</div>
<div class="callout-body-container callout-body">
<p>For geographic coordinates (latitude, longitude), we can’t use simple Euclidean distance because Earth is a sphere!</p>
<p>The <strong>Haversine formula</strong> calculates great-circle distance:</p>
<p><span class="math display">\[d = 2r \arcsin\left(\sqrt{\sin^2\left(\frac{\Delta\phi}{2}\right) + \cos(\phi_1)\cos(\phi_2)\sin^2\left(\frac{\Delta\lambda}{2}\right)}\right)\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(r\)</span> = Earth’s radius (≈ 6371 km)</li>
<li><span class="math inline">\(\phi\)</span> = latitude in radians</li>
<li><span class="math inline">\(\lambda\)</span> = longitude in radians</li>
</ul>
</div>
</div>
<p>Here it is already implemented, you just need to call it:</p>
<div id="a0efe277" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> haversine_distance(loc1: Tuple[<span class="bu">float</span>, <span class="bu">float</span>], loc2: Tuple[<span class="bu">float</span>, <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate distance in km between two (lat, lon) points using Haversine formula."""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    lat1, lon1 <span class="op">=</span> loc1</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    lat2, lon2 <span class="op">=</span> loc2</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to radians</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    lat1_rad <span class="op">=</span> math.radians(lat1)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    lat2_rad <span class="op">=</span> math.radians(lat2)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    lon1_rad <span class="op">=</span> math.radians(lon1)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    lon2_rad <span class="op">=</span> math.radians(lon2)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Differences</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    dlat <span class="op">=</span> lat2_rad <span class="op">-</span> lat1_rad</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    dlon <span class="op">=</span> lon2_rad <span class="op">-</span> lon1_rad</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Haversine formula</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> math.sin(dlat<span class="op">/</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> math.cos(lat1_rad) <span class="op">*</span> math.cos(lat2_rad) <span class="op">*</span> math.sin(dlon<span class="op">/</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.asin(math.sqrt(a))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    R <span class="op">=</span> <span class="dv">6371</span>  <span class="co"># Earth's radius in km</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> R <span class="op">*</span> c</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the distance function</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>test_dist <span class="op">=</span> haversine_distance((<span class="fl">51.5074</span>, <span class="op">-</span><span class="fl">0.1278</span>), (<span class="fl">48.8566</span>, <span class="fl">2.3522</span>))  <span class="co"># London to Paris</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Example: London to Paris = </span><span class="sc">{</span>test_dist<span class="sc">:.1f}</span><span class="ss"> km"</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>test_dist2 <span class="op">=</span> haversine_distance((<span class="fl">52.5200</span>, <span class="fl">13.4050</span>), (<span class="fl">48.2082</span>, <span class="fl">16.3738</span>))  <span class="co"># Berlin to Vienna</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Example: Berlin to Vienna = </span><span class="sc">{</span>test_dist2<span class="sc">:.1f}</span><span class="ss"> km"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Example: London to Paris = 343.6 km
Example: Berlin to Vienna = 523.5 km</code></pre>
</div>
</div>
<p>Great! Now we can calculate real distances between any two locations in Europe.</p>
</section>
<section id="exercise-1.1-implement-the-network-cost-function-with-balanced-allocation" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1.1-implement-the-network-cost-function-with-balanced-allocation">Exercise 1.1: Implement the Network Cost Function with Balanced Allocation</h2>
<p>This is the <strong>heart</strong> of the optimization, the function that determines if a network design is good or bad.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Working with Sets in Python
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>set</strong> is an unordered collection with no duplicates:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>unassigned <span class="op">=</span> {<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>unassigned.remove(<span class="dv">3</span>)      <span class="co"># Remove element (error if not found)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(unassigned)           <span class="co"># Number of elements</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="kw">in</span> unassigned           <span class="co"># Check membership (fast!)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why use sets here?</strong> Fast membership testing and removal. Perfect for tracking which cafés still need assignment!</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Balanced Allocation Strategy
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key Innovation</strong>: Each center gets exactly 20 cafés (1000 ÷ 50 = 20)</p>
<p><strong>Greedy Assignment Process</strong>:</p>
<ol type="1">
<li>For each selected center:
<ul>
<li>Find the 20 nearest unassigned cafés</li>
<li>Assign them to this center</li>
<li>Mark them as assigned</li>
</ul></li>
<li>Sum up all delivery distances</li>
<li>Calculate total cost</li>
</ol>
<p><strong>Why this is better</strong>:</p>
<ul>
<li><strong>Always feasible</strong> - balanced load by construction</li>
<li><strong>No capacity violations</strong> - each center gets exactly 20 cafés</li>
<li><strong>Realistic</strong> - distribution territories are typically balanced</li>
<li><strong>Simple</strong> - no penalty functions or feasibility checks needed</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here’s the implementation plan:</p>
<ol type="1">
<li><strong>Loop through each selected center</strong> to assign its 20 cafés</li>
<li><strong>For each center</strong>, calculate distances to ALL unassigned cafés using <code>haversine_distance</code></li>
<li><strong>Store results as tuples</strong>: <code>[(distance1, cafe_idx1), (distance2, cafe_idx2), ...]</code></li>
<li><strong>Sort the list</strong> by distance using <code>.sort()</code> (smallest first)</li>
<li><strong>Take the first 20</strong> using list slicing <code>[:cafes_per_center]</code></li>
<li><strong>Add distances to total</strong> and remove assigned cafés from the <code>unassigned_cafes</code> set</li>
</ol>
<p><strong>Hint</strong>: Loop <code>for cafe_idx in unassigned_cafes:</code> to build the distance list!</p>
</div>
</div>
<div id="5bed814d" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_network_cost(selected_centers: List[<span class="bu">int</span>],</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                          cafe_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                          center_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                          cafes_per_center: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate total annual cost using balanced greedy allocation.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">        selected_centers: List of indices (0-199) of selected centers</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">        cafe_locs: List of (lat, lon) tuples for cafés</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">        center_locs: List of (lat, lon) tuples for potential centers</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">        cafes_per_center: Number of cafés each center serves (default 20)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">        total_cost: Total annual cost in €</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fixed facility cost</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    facility_cost <span class="op">=</span> <span class="dv">500_000</span> <span class="op">*</span> <span class="bu">len</span>(selected_centers)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Track which cafés have been assigned</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    unassigned_cafes <span class="op">=</span> <span class="bu">set</span>(<span class="bu">range</span>(<span class="bu">len</span>(cafe_locs)))</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    total_daily_distance <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Greedily assign cafés to each center</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> center_idx <span class="kw">in</span> selected_centers:</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        center_loc <span class="op">=</span> center_locs[center_idx]</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 1: Calculate distances from this center to all unassigned cafés</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        distances_to_unassigned <span class="op">=</span> []</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> cafe_idx <span class="kw">in</span> unassigned_cafes:</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>            distance <span class="op">=</span> <span class="co"># YOUR CODE - calculate distance using haversine_distance</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>            distances_to_unassigned.append((distance, cafe_idx))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 2: Sort by distance and take the nearest cafes_per_center cafés</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        distances_to_unassigned.sort()</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        nearest_cafes <span class="op">=</span> distances_to_unassigned[:cafes_per_center]</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 3: Add their distances to the total and mark as assigned</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> distance, cafe_idx <span class="kw">in</span> nearest_cafes:</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>            total_daily_distance <span class="op">+=</span> distance</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>            unassigned_cafes.remove(cafe_idx)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delivery cost: €2/km/day × 365 days</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    delivery_cost <span class="op">=</span> total_daily_distance <span class="op">*</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">365</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    total_cost <span class="op">=</span> facility_cost <span class="op">+</span> delivery_cost</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_cost</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6a8dfc5d" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test your cost function with a random network</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>test_centers <span class="op">=</span> random.sample(<span class="bu">range</span>(<span class="dv">200</span>), <span class="dv">50</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>test_cost <span class="op">=</span> calculate_network_cost(test_centers, cafe_locations, potential_centers)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> test_cost <span class="op">&gt;</span> <span class="dv">25_000_000</span>, <span class="st">"Cost should be &gt; facility cost alone"</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> test_cost <span class="op">&lt;</span> <span class="dv">300_000_000</span>, <span class="ss">f"Cost seems too high: €</span><span class="sc">{</span>test_cost<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Cost function working!"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Random network cost: €</span><span class="sc">{</span>test_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Facility cost: €25,000,000"</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Delivery cost: €</span><span class="sc">{</span>test_cost <span class="op">-</span> <span class="dv">25_000_000</span><span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Note: Each center serves exactly 20 cafés - always balanced and feasible!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="helper-function-get-café-center-assignments" class="level2">
<h2 class="anchored" data-anchor-id="helper-function-get-café-center-assignments">Helper Function: Get Café-Center Assignments</h2>
<p>No need to do anything here, we’ll use this function to determine which cafés are assigned to which centers for visualization:</p>
<div id="a9b89553" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_cafe_assignments(selected_centers: List[<span class="bu">int</span>],</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                         cafe_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                         center_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                         cafes_per_center: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> <span class="bu">dict</span>:</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Get the assignment of cafés to centers using the same greedy allocation as the cost function.</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Dictionary mapping center_idx -&gt; list of assigned café indices</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    unassigned_cafes <span class="op">=</span> <span class="bu">set</span>(<span class="bu">range</span>(<span class="bu">len</span>(cafe_locs)))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    assignments <span class="op">=</span> {}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> center_idx <span class="kw">in</span> selected_centers:</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        center_loc <span class="op">=</span> center_locs[center_idx]</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate distances from this center to all unassigned cafés</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        distances_to_unassigned <span class="op">=</span> []</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> cafe_idx <span class="kw">in</span> unassigned_cafes:</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>            distance <span class="op">=</span> haversine_distance(center_loc, cafe_locs[cafe_idx])</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>            distances_to_unassigned.append((distance, cafe_idx))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort by distance and take the nearest cafes_per_center cafés</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        distances_to_unassigned.sort()</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        nearest_cafes <span class="op">=</span> distances_to_unassigned[:cafes_per_center]</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Record assignments</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        assignments[center_idx] <span class="op">=</span> [cafe_idx <span class="cf">for</span> _, cafe_idx <span class="kw">in</span> nearest_cafes]</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Mark as assigned</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _, cafe_idx <span class="kw">in</span> nearest_cafes:</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>            unassigned_cafes.remove(cafe_idx)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> assignments</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualize-initial-random-solution" class="level2">
<h2 class="anchored" data-anchor-id="visualize-initial-random-solution">Visualize Initial Random Solution</h2>
<p>Let’s see what our random baseline looks like with connection lines:</p>
<div id="48ed8509" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the initial random solution</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get assignments for the random solution</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>random_assignments <span class="op">=</span> get_cafe_assignments(test_centers, cafe_locations, potential_centers)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot connection lines first (so they appear behind markers)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center_idx, cafe_indices <span class="kw">in</span> random_assignments.items():</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    center_loc <span class="op">=</span> potential_centers[center_idx]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cafe_idx <span class="kw">in</span> cafe_indices:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>        cafe_loc <span class="op">=</span> cafe_locations[cafe_idx]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>        plt.plot([center_loc[<span class="dv">1</span>], cafe_loc[<span class="dv">1</span>]], [center_loc[<span class="dv">0</span>], cafe_loc[<span class="dv">0</span>]], </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all locations        </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>plt.scatter(center_lons, center_lats, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Potential Centers (200)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot cafés</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>cafe_lats <span class="op">=</span> [loc[<span class="dv">0</span>] <span class="cf">for</span> loc <span class="kw">in</span> cafe_locations]</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>cafe_lons <span class="op">=</span> [loc[<span class="dv">1</span>] <span class="cf">for</span> loc <span class="kw">in</span> cafe_locations]</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>plt.scatter(cafe_lons, cafe_lats, s<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'Cafés (1000)'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot selected centers</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>selected_lats <span class="op">=</span> [potential_centers[i][<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> test_centers]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>selected_lons <span class="op">=</span> [potential_centers[i][<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> test_centers]</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>plt.scatter(selected_lons, selected_lats, s<span class="op">=</span><span class="dv">150</span>, alpha<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'*'</span>, label<span class="op">=</span><span class="st">'Random Centers (50)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>           linewidth<span class="op">=</span><span class="dv">2</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Initial Random Solution: €</span><span class="sc">{</span>test_cost<span class="sc">:,.0f}</span><span class="ss">/year</span><span class="ch">\n</span><span class="ss">(Each line connects a café to its distribution center)'</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>baseline_random_cost <span class="op">=</span> test_cost  <span class="co"># Save for comparison</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="section-2-greedy-construction---the-baseline" class="level1">
<h1>Section 2: Greedy Construction - The Baseline</h1>
<p>Let’s start with the simplest approach: pick the 50 centers that minimize total distance to cafés.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Greedy Algorithm Strategy
</div>
</div>
<div class="callout-body-container callout-body">
<p>At each step, pick the center that gives the <strong>biggest immediate benefit</strong>:</p>
<ol type="1">
<li>Start with empty selection</li>
<li>For each of 50 iterations:
<ul>
<li>Try adding each remaining center</li>
<li>Calculate the cost with balanced allocation</li>
<li>Add the center with the lowest cost</li>
</ul></li>
<li>Return final selection</li>
</ol>
<p><strong>Note</strong>: With balanced allocation, every solution is automatically feasible!</p>
</div>
</div>
<section id="exercise-2.1-implement-greedy-center-selection" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.1-implement-greedy-center-selection">Exercise 2.1: Implement Greedy Center Selection</h2>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>The greedy algorithm picks centers one at a time, always choosing the best addition:</p>
<ol type="1">
<li><strong>Loop 50 times</strong> (one for each center to select)</li>
<li><strong>For each candidate</strong> in the remaining centers:
<ul>
<li>Create <code>temp_selection = selected + [candidate]</code></li>
<li>Calculate the cost if we selected this candidate</li>
<li>Track the candidate with the lowest cost</li>
</ul></li>
<li><strong>Add the best candidate</strong> to <code>selected</code> and remove from <code>remaining</code></li>
</ol>
<p><strong>Key insight</strong>: This is expensive (trying ~150 centers × 50 times = 7,500 cost calculations), but it builds a good initial solution!</p>
</div>
</div>
<div id="05802754" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_center_selection(cafe_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                           center_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                           n_select: <span class="bu">int</span> <span class="op">=</span> <span class="dv">50</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Select distribution centers using greedy algorithm.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">        cafe_locs: Café locations</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">        center_locs: Potential center locations</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">        n_select: Number of centers to select</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">        List of selected center indices</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    selected <span class="op">=</span> []</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    remaining <span class="op">=</span> <span class="bu">set</span>(<span class="bu">range</span>(<span class="bu">len</span>(center_locs)))</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Greedy selection: Selecting </span><span class="sc">{</span>n_select<span class="sc">}</span><span class="ss"> centers..."</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> step <span class="kw">in</span> <span class="bu">range</span>(n_select):</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        best_center <span class="op">=</span> <span class="va">None</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        best_cost <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 1: Try adding each remaining center</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> candidate <span class="kw">in</span> remaining:</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 2: Create temporary selection with this candidate added</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>            temp_selection <span class="op">=</span> selected <span class="op">+</span> [candidate]</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 3: Calculate cost with balanced allocation</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>            cost <span class="op">=</span> <span class="co"># YOUR CODE - use calculate_network_cost</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 4: Track if this is the best so far</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cost <span class="op">&lt;</span> best_cost:</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>                best_cost <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>                best_center <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add the best center found</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        selected.append(best_center)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        remaining.remove(best_center)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (step <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Selected </span><span class="sc">{</span>step <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>n_select<span class="sc">}</span><span class="ss"> centers, current cost: €</span><span class="sc">{</span>best_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> selected</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6eec43df" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run greedy algorithm</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>greedy_solution <span class="op">=</span> greedy_center_selection(cafe_locations, potential_centers, <span class="dv">50</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>greedy_cost <span class="op">=</span> calculate_network_cost(greedy_solution, cafe_locations, potential_centers)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="ced0976c" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test greedy solution</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(greedy_solution) <span class="op">==</span> <span class="dv">50</span>, <span class="st">"Should select exactly 50 centers"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(<span class="bu">set</span>(greedy_solution)) <span class="op">==</span> <span class="dv">50</span>, <span class="st">"Should not select duplicates"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> greedy_cost <span class="op">&lt;</span> test_cost, <span class="ss">f"Greedy should beat random baseline, got €</span><span class="sc">{</span>greedy_cost<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>baseline_random_cost <span class="op">=</span> test_cost  <span class="co"># Historical random selection</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>greedy_savings <span class="op">=</span> baseline_random_cost <span class="op">-</span> greedy_cost</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>greedy_improvement_pct <span class="op">=</span> (greedy_savings <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Greedy algorithm complete!"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Greedy network cost: €</span><span class="sc">{</span>greedy_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"vs. Current random network: €</span><span class="sc">{</span>baseline_random_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Annual savings: €</span><span class="sc">{</span>greedy_savings<span class="sc">:,.0f}</span><span class="ss"> (</span><span class="sc">{</span>greedy_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="visualize-the-greedy-solution" class="level2">
<h2 class="anchored" data-anchor-id="visualize-the-greedy-solution">Visualize the Greedy Solution</h2>
<div id="0117c158" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get assignments for the greedy solution</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>greedy_assignments <span class="op">=</span> get_cafe_assignments(greedy_solution, cafe_locations, potential_centers)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot connection lines first (so they appear behind markers)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center_idx, cafe_indices <span class="kw">in</span> greedy_assignments.items():</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    center_loc <span class="op">=</span> potential_centers[center_idx]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cafe_idx <span class="kw">in</span> cafe_indices:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        cafe_loc <span class="op">=</span> cafe_locations[cafe_idx]</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        plt.plot([center_loc[<span class="dv">1</span>], cafe_loc[<span class="dv">1</span>]], [center_loc[<span class="dv">0</span>], cafe_loc[<span class="dv">0</span>]], </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all locations        </span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>plt.scatter(center_lons, center_lats, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Potential Centers (200)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all cafés</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>plt.scatter(cafe_lons, cafe_lats, s<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'Cafés'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot unselected centers</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>unselected <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>) <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> greedy_solution]</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>unselected_lats <span class="op">=</span> [potential_centers[i][<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> unselected]</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>unselected_lons <span class="op">=</span> [potential_centers[i][<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> unselected]</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.scatter(unselected_lons, unselected_lats, s<span class="op">=</span><span class="dv">40</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'gray'</span>,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Unselected Centers'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot selected centers</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>selected_lats <span class="op">=</span> [potential_centers[i][<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> greedy_solution]</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>selected_lons <span class="op">=</span> [potential_centers[i][<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> greedy_solution]</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.scatter(selected_lons, selected_lats, s<span class="op">=</span><span class="dv">150</span>, alpha<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'*'</span>, label<span class="op">=</span><span class="st">'Greedy Selected (50)'</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>           linewidth<span class="op">=</span><span class="dv">1</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Greedy Solution: €</span><span class="sc">{</span>greedy_cost<span class="sc">:,.0f}</span><span class="ss">/year (</span><span class="sc">{</span>greedy_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)</span><span class="ch">\n</span><span class="ss">(Blue lines show café-to-center assignments)'</span>,</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>The Greedy Trap
</div>
</div>
<div class="callout-body-container callout-body">
<p>Greedy saved us some money! But greedy algorithms are <strong>short-sighted</strong>:</p>
<ul>
<li>They make locally optimal choices</li>
<li>They never reconsider earlier decisions</li>
<li>They can’t escape suboptimal patterns</li>
</ul>
<p><strong>Can we do better?</strong></p>
</div>
</div>
</section>
</section>
<section id="section-3-local-search" class="level1">
<h1>Section 3: Local Search</h1>
<p>Remember <strong>2-opt swaps</strong> from the routing notebook? There, we improved routes by reversing segments. Here, we’ll use the <strong>same local search philosophy</strong> but with a different neighborhood:</p>
<p><strong>Routing:</strong> Swap edges in a route (reverse a segment)<br>
<strong>Distribution Network:</strong> Swap centers in/out of the selection</p>
<p>The core idea remains: <strong>make small changes, keep improvements, stop at local optimum</strong>.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Local Search
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Core idea</strong>: Start with a solution, repeatedly make small changes that improve it.</p>
<p><strong>The local search pattern</strong>:</p>
<ol type="1">
<li>Start with current solution</li>
<li>Generate a <strong>neighbor</strong> (slightly different solution)</li>
<li>If neighbor is better, keep it</li>
<li>Repeat until no improvement found</li>
</ol>
<p><strong>Problem</strong>: Gets stuck in <strong>local optima</strong> (can’t improve further, but not the global best)</p>
</div>
</div>
<section id="exercise-3.1-implement-the-swap-neighborhood" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3.1-implement-the-swap-neighborhood">Exercise 3.1: Implement the Swap Neighborhood</h2>
<p>Create a neighbor by swapping one selected center with one unselected center.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>List Comprehensions for Filtering
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create new lists based on conditions in one line:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Traditional approach</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>unselected <span class="op">=</span> []</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> current_selection:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        unselected.append(i)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># List comprehension (same result, cleaner!)</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>unselected <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">200</span>) <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> current_selection]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Pattern:</strong> <code>[expression for item in iterable if condition]</code></p>
<p>This is perfect for finding which centers are NOT currently selected!</p>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>Your implementation steps:</p>
<ol type="1">
<li><strong>Find unselected centers</strong>: <code>[i for i in range(n_centers) if i not in current_selection]</code></li>
<li><strong>Pick a random position</strong> to remove from current_selection: <code>random.randint(0, len(current_selection) - 1)</code></li>
<li><strong>Pick a random center</strong> to add: <code>random.choice(unselected)</code></li>
<li><strong>Create a copy</strong> of current_selection and replace the element at the random index with the new center</li>
</ol>
<p><strong>Hint</strong>: Use <code>.copy()</code> to avoid modifying the original list!</p>
</div>
</div>
<div id="1032c5fa" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_swap_neighbor(current_selection: List[<span class="bu">int</span>],</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                          n_centers: <span class="bu">int</span> <span class="op">=</span> <span class="dv">200</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate a neighbor by swapping one selected center with one unselected.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">        current_selection: Current list of selected centers</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">        n_centers: Total number of potential centers</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">        New selection with one center swapped</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get unselected centers</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    unselected <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_centers) <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> current_selection]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pick random indices</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    remove_idx <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(current_selection) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    add_center <span class="op">=</span> random.choice(unselected)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create new selection</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    new_selection <span class="op">=</span> current_selection.copy()</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># YOUR CODE: remove and add based on indices</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_selection</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="819731e4" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test swap function</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>test_neighbor <span class="op">=</span> generate_swap_neighbor(greedy_solution)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(test_neighbor) <span class="op">==</span> <span class="dv">50</span>, <span class="st">"Neighbor should have 50 centers"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(<span class="bu">set</span>(test_neighbor)) <span class="op">==</span> <span class="dv">50</span>, <span class="st">"No duplicates"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(<span class="bu">set</span>(test_neighbor) <span class="op">&amp;</span> <span class="bu">set</span>(greedy_solution)) <span class="op">==</span> <span class="dv">49</span>, <span class="st">"Should differ by exactly 1 center"</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1-opt neighbor generation working!"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Changed 1 center from the solution"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="exercise-3.2-implement-local-search" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3.2-implement-local-search">Exercise 3.2: Implement Local Search</h2>
<p>Now implement the full local search algorithm.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>Local search repeatedly tries to improve the current solution:</p>
<ol type="1">
<li><strong>Try multiple neighbors</strong> each iteration (parameter: <code>neighbors_per_iteration</code>)</li>
<li><strong>For each neighbor</strong>:
<ul>
<li>Generate it using <code>generate_swap_neighbor(current)</code></li>
<li>Calculate its cost using <code>calculate_network_cost(...)</code></li>
<li>If better than current, <strong>accept it immediately</strong> and break the inner loop</li>
</ul></li>
<li><strong>Track improvements</strong>: Increment counter when you accept a neighbor</li>
<li><strong>Stop when stuck</strong>: If you try all neighbors and none improve, you’ve reached a local optimum</li>
</ol>
<p><strong>Key difference from greedy</strong>: Greedy builds from scratch; local search improves an existing solution!</p>
</div>
</div>
<div id="735e9666" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_search(initial_solution: List[<span class="bu">int</span>],</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                cafe_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                center_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1000</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                neighbors_per_iteration: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], <span class="bu">float</span>, <span class="bu">int</span>]:</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Improve a solution using local search.</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">        initial_solution: Starting selection of centers</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">        cafe_locs: Café locations</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">        center_locs: Center locations</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co">        max_iterations: Maximum improvement iterations</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co">        neighbors_per_iteration: How many neighbors to try each iteration</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">        (best_solution, best_cost, num_improvements)</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> initial_solution.copy()</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    current_cost <span class="op">=</span> calculate_network_cost(current, cafe_locs, center_locs)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    improvements <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Local search starting..."</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>        improved <span class="op">=</span> <span class="va">False</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Step 1: Try multiple neighbors per iteration</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(neighbors_per_iteration):</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 2: Generate neighbor</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>            neighbor <span class="op">=</span> <span class="co"># YOUR CODE - use generate_swap_neighbor</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 3: Evaluate neighbor</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>            neighbor_cost <span class="op">=</span> <span class="co"># YOUR CODE - use calculate_network_cost</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 4: If better, keep it and break inner loop</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor_cost <span class="op">&lt;</span> current_cost:</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                current <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                current_cost <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>                improvements <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>                improved <span class="op">=</span> <span class="va">True</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> improved <span class="kw">and</span> (improvements <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span> <span class="dv">0</span>):</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"  Iteration </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>improvements<span class="sc">}</span><span class="ss"> improvements, cost: €</span><span class="sc">{</span>current_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> improved:</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Local optimum reached after </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss"> iterations"</span>)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current, current_cost, improvements</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9a4df100" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run local search from greedy solution</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ls_solution, ls_cost, ls_improvements <span class="op">=</span> local_search(greedy_solution, cafe_locations, potential_centers)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="6fb667b0" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test local search</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ls_cost <span class="op">&lt;=</span> greedy_cost, <span class="st">"Local search shouldn't make solution worse"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> ls_improvements <span class="op">&gt;=</span> <span class="dv">0</span>, <span class="st">"Should track improvements"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ls_savings <span class="op">=</span> baseline_random_cost <span class="op">-</span> ls_cost</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>ls_improvement_pct <span class="op">=</span> (ls_savings <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Local search complete!"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Local search cost: €</span><span class="sc">{</span>ls_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"vs. Greedy: €</span><span class="sc">{</span>greedy_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Additional savings: €</span><span class="sc">{</span>greedy_cost <span class="op">-</span> ls_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total vs. baseline: €</span><span class="sc">{</span>ls_savings<span class="sc">:,.0f}</span><span class="ss"> (</span><span class="sc">{</span>ls_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of swaps: </span><span class="sc">{</span>ls_improvements<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="visualize-local-search-solution" class="level2">
<h2 class="anchored" data-anchor-id="visualize-local-search-solution">Visualize Local Search Solution</h2>
<div id="db19c5d5" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get assignments for the local search solution</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>ls_assignments <span class="op">=</span> get_cafe_assignments(ls_solution, cafe_locations, potential_centers)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot connection lines first (so they appear behind markers)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center_idx, cafe_indices <span class="kw">in</span> ls_assignments.items():</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    center_loc <span class="op">=</span> potential_centers[center_idx]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cafe_idx <span class="kw">in</span> cafe_indices:</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        cafe_loc <span class="op">=</span> cafe_locations[cafe_idx]</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        plt.plot([center_loc[<span class="dv">1</span>], cafe_loc[<span class="dv">1</span>]], [center_loc[<span class="dv">0</span>], cafe_loc[<span class="dv">0</span>]], </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'mediumseagreen'</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all locations        </span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>plt.scatter(center_lons, center_lats, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Potential Centers (200)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all cafés</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>plt.scatter(cafe_lons, cafe_lats, s<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'Cafés'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot selected centers</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>selected_lats <span class="op">=</span> [potential_centers[i][<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> ls_solution]</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>selected_lons <span class="op">=</span> [potential_centers[i][<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> ls_solution]</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>plt.scatter(selected_lons, selected_lats, s<span class="op">=</span><span class="dv">150</span>, alpha<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">'mediumseagreen'</span>,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'*'</span>, label<span class="op">=</span><span class="st">'Local Search Selected (50)'</span>, edgecolors<span class="op">=</span><span class="st">'darkgreen'</span>, </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>           linewidth<span class="op">=</span><span class="dv">1</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Local Search Solution: €</span><span class="sc">{</span>ls_cost<span class="sc">:,.0f}</span><span class="ss">/year (</span><span class="sc">{</span>ls_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)</span><span class="ch">\n</span><span class="ss">(Improved from Greedy by </span><span class="sc">{</span>ls_improvements<span class="sc">}</span><span class="ss"> swaps)'</span>,</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-simple callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>The Local Optimum Problem
</div>
</div>
<div class="callout-body-container callout-body">
<p>Local search potentially finds a better solution than greedy, but this is not always the case as it can easily be <strong>stuck at a local optimum</strong>:</p>
<ul>
<li>No single swap improves the solution</li>
<li>But a <strong>sequence</strong> of swaps (including temporary bad moves) might lead somewhere better</li>
<li>Like hiking: sometimes you must go downhill briefly to reach a higher peak</li>
</ul>
<p><strong>This is why we need metaheuristics!</strong></p>
</div>
</div>
</section>
</section>
<section id="section-4-simulated-annealing---escaping-local-optima" class="level1">
<h1>Section 4: Simulated Annealing - Escaping Local Optima</h1>
<p>Simulated Annealing (SA) is inspired by metallurgy: heating metal allows atoms to escape local patterns and find better arrangements as it cools.</p>
<section id="exercise-4.1-implement-the-sa-acceptance-criterion" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4.1-implement-the-sa-acceptance-criterion">Exercise 4.1: Implement the SA Acceptance Criterion</h2>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>Idea: Sometimes accept <strong>worse</strong> solutions to escape local optima!</p>
<p>Implementation is straightforward:</p>
<ol type="1">
<li><strong>If improvement</strong> (new_cost &lt; current_cost): Always return <code>True</code></li>
<li><strong>If worse</strong> (new_cost &gt;= current_cost):
<ul>
<li>Calculate <code>delta = new_cost - current_cost</code></li>
<li>Calculate <code>probability = math.exp(-delta / temperature)</code></li>
<li>Return <code>True</code> with that probability: <code>random.random() &lt; probability</code></li>
</ul></li>
</ol>
<p><strong>Key insight</strong>: As temperature decreases, probability → 0, so SA becomes greedy!</p>
</div>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Acceptance Probability - Concrete Examples
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Scenario 1: Small cost increase, high temperature</strong></p>
<ul>
<li>Current: €40,000,000</li>
<li>Neighbor: €40,100,000 (€100K worse)</li>
<li>Temperature: T = 1,000,000</li>
<li>Delta = 100,000</li>
<li>Probability = exp(-100,000 / 1,000,000) = exp(-0.1) ≈ <strong>90.5%</strong> → Often accept!</li>
</ul>
<p><strong>Scenario 2: Same increase, low temperature</strong></p>
<ul>
<li>Current: €40,000,000</li>
<li>Neighbor: €40,100,000 (€100K worse)</li>
<li>Temperature: T = 1,000</li>
<li>Delta = 100,000</li>
<li>Probability = exp(-100,000 / 1,000) = exp(-100) ≈ <strong>0.0%</strong> → Reject!</li>
</ul>
<p><strong>Scenario 3: Large increase, high temperature</strong></p>
<ul>
<li>Current: €40,000,000</li>
<li>Neighbor: €42,000,000 (€2M worse!)</li>
<li>Temperature: T = 1,000,000</li>
<li>Delta = 2,000,000</li>
<li>Probability = exp(-2,000,000 / 1,000,000) = exp(-2) ≈ <strong>13.5%</strong> → Sometimes accept!</li>
</ul>
<p><strong>The pattern</strong>: Higher temperature → more exploration. Lower temperature → more exploitation.</p>
</div>
</div>
<div id="db19d730" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> accept_move(current_cost: <span class="bu">float</span>, new_cost: <span class="bu">float</span>, temperature: <span class="bu">float</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Decide whether to accept a move in simulated annealing.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">        current_cost: Current solution cost</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">        new_cost: Candidate solution cost</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">        temperature: Current temperature</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">        True if move should be accepted</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> new_cost <span class="op">&lt;</span> current_cost:</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span>  <span class="co"># Always accept improvements</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate acceptance probability</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        delta <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> random.random() <span class="op">&lt;</span> probability</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c1921f75" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test acceptance function</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># At high temp, should accept worse moves frequently</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>high_temp_accepts <span class="op">=</span> <span class="bu">sum</span>(accept_move(<span class="dv">1000</span>, <span class="dv">1100</span>, temperature<span class="op">=</span><span class="dv">500</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> high_temp_accepts <span class="op">&gt;</span> <span class="dv">300</span>, <span class="ss">f"High temp should accept ~60% of moves, got </span><span class="sc">{</span>high_temp_accepts<span class="op">/</span><span class="dv">10</span><span class="sc">}</span><span class="ss">%"</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># At low temp, should reject worse moves</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>low_temp_accepts <span class="op">=</span> <span class="bu">sum</span>(accept_move(<span class="dv">1000</span>, <span class="dv">1100</span>, temperature<span class="op">=</span><span class="dv">10</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> low_temp_accepts <span class="op">&lt;</span> <span class="dv">200</span>, <span class="ss">f"Low temp should accept &lt;20% of moves, got </span><span class="sc">{</span>low_temp_accepts<span class="op">/</span><span class="dv">10</span><span class="sc">}</span><span class="ss">%"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Always accept improvements</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>improvements <span class="op">=</span> <span class="bu">sum</span>(accept_move(<span class="dv">1000</span>, <span class="dv">900</span>, temperature<span class="op">=</span><span class="dv">100</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>))</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> improvements <span class="op">==</span> <span class="dv">100</span>, <span class="st">"Should always accept improvements"</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Acceptance criterion working!"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"High temp (T=500): </span><span class="sc">{</span>high_temp_accepts<span class="op">/</span><span class="dv">10</span><span class="sc">:.1f}</span><span class="ss">% acceptance for +€100 move"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Low temp (T=10): </span><span class="sc">{</span>low_temp_accepts<span class="op">/</span><span class="dv">10</span><span class="sc">:.1f}</span><span class="ss">% acceptance for +€100 move"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="exercise-4.2-implement-simulated-annealing" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4.2-implement-simulated-annealing">Exercise 4.2: Implement Simulated Annealing</h2>
<p>Now put it all together! I will provide the cooling schedule, you implement the main loop.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Cooling Schedule
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll use <strong>geometric cooling</strong>: <code>T_new = α × T_old</code></p>
<ul>
<li>Initial temperature: <code>T₀ = 10,000</code> (accept moves up to ~€10K worse initially)</li>
<li>Cooling rate: <code>α = 0.995</code> (slow cooling for thorough exploration)</li>
<li>Stop when: <code>T &lt; 1</code> (essentially greedy behavior)</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Before You Start
</div>
</div>
<div class="callout-body-container callout-body">
<p>SA has TWO solutions to track (unlike local search which only tracks one):</p>
<ol type="1">
<li><strong>Current solution</strong>: The solution we’re currently exploring (can get worse!)</li>
<li><strong>Best solution</strong>: The best solution ever found (never gets worse)</li>
</ol>
<p><strong>Why both?</strong> We need to accept worse moves to escape local optima, but we don’t want to forget the best solution we’ve seen!</p>
<p><strong>Your implementation steps:</strong></p>
<ol type="1">
<li>Generate a neighbor using <code>generate_swap_neighbor(current)</code></li>
<li>Calculate its cost using <code>calculate_network_cost(...)</code></li>
<li>Use <code>accept_move(current_cost, neighbor_cost, temperature)</code> to decide</li>
<li><strong>If accepted</strong>: Update <code>current</code> and <code>current_cost</code> (even if worse!)</li>
<li><strong>Then check</strong>: If current is better than best ever, update <code>best</code> and <code>best_cost</code></li>
</ol>
<p><strong>Critical</strong>: Track best separately from current!</p>
</div>
</div>
<div id="9b42d5e7" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulated_annealing(initial_solution: List[<span class="bu">int</span>],</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       cafe_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       center_locs: List[Tuple[<span class="bu">float</span>, <span class="bu">float</span>]],</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       initial_temp: <span class="bu">float</span> <span class="op">=</span> <span class="dv">10000</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       cooling_rate: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       min_temp: <span class="bu">float</span> <span class="op">=</span> <span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], <span class="bu">float</span>, List[<span class="bu">float</span>]]:</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Optimize using simulated annealing.</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">        initial_solution: Starting selection</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">        cafe_locs: Café locations</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">        center_locs: Center locations</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">        initial_temp: Starting temperature</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">        cooling_rate: Temperature multiplier each iteration</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">        min_temp: Stop when temperature reaches this</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co">        (best_solution, best_cost, cost_history)</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> initial_solution.copy()</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    current_cost <span class="op">=</span> calculate_network_cost(current, cafe_locs, center_locs)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> current.copy()</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    best_cost <span class="op">=</span> current_cost</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    temperature <span class="op">=</span> initial_temp</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    cost_history <span class="op">=</span> [current_cost]</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    iteration <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"SA starting from €</span><span class="sc">{</span>current_cost<span class="sc">:,.0f}</span><span class="ss"> with T=</span><span class="sc">{</span>initial_temp<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> temperature <span class="op">&gt;</span> min_temp:</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):  <span class="co"># 10 neighbors per temperature step</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 1: Generate a neighbor</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>            neighbor <span class="op">=</span> <span class="co"># YOUR CODE - use generate_swap_neighbor</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 2: Calculate its cost</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>            neighbor_cost <span class="op">=</span> <span class="co"># YOUR CODE - use calculate_network_cost</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Step 3: Decide whether to accept using accept_move function</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> accept_move(current_cost, neighbor_cost, temperature):</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Step 4: Update current solution (even if worse!)</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>                current <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>                current_cost <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Step 5: Track best ever found</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> current_cost <span class="op">&lt;</span> best_cost:</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>                    best <span class="op">=</span> <span class="co"># YOUR CODE - use .copy()!</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>                    best_cost <span class="op">=</span> <span class="co"># YOUR CODE</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>            iteration <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> iteration <span class="op">%</span> <span class="dv">200</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"  Iteration </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss">: T=</span><span class="sc">{</span>temperature<span class="sc">:.1f}</span><span class="ss">, Current=€</span><span class="sc">{</span>current_cost<span class="sc">:,.0f}</span><span class="ss">, Best=€</span><span class="sc">{</span>best_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Cool down</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>        temperature <span class="op">*=</span> cooling_rate</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>        cost_history.append(current_cost)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"SA complete after </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss"> iterations"</span>)</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best, best_cost, cost_history</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f05b7093" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run simulated annealing from greedy solution</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sa_solution, sa_cost, sa_history <span class="op">=</span> simulated_annealing(greedy_solution, cafe_locations, potential_centers)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="b3b30d25" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test SA</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> sa_cost <span class="op">&lt;=</span> greedy_cost, <span class="st">"SA should improve upon starting solution"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">len</span>(sa_history) <span class="op">&gt;</span> <span class="dv">100</span>, <span class="st">"Should have run many iterations"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>sa_savings <span class="op">=</span> baseline_random_cost <span class="op">-</span> sa_cost</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>sa_improvement_pct <span class="op">=</span> (sa_savings <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Simulated Annealing complete!"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"SA cost: €</span><span class="sc">{</span>sa_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"vs. Local Search: €</span><span class="sc">{</span>ls_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"vs. Greedy: €</span><span class="sc">{</span>greedy_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Additional savings over LS: €</span><span class="sc">{</span>ls_cost <span class="op">-</span> sa_cost<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total vs. baseline: €</span><span class="sc">{</span>sa_savings<span class="sc">:,.0f}</span><span class="ss"> (</span><span class="sc">{</span>sa_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="visualize-sa-evolution" class="level2">
<h2 class="anchored" data-anchor-id="visualize-sa-evolution">Visualize SA Evolution</h2>
<div id="907cb007" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cost evolution</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>ax1.plot(sa_history, alpha<span class="op">=</span><span class="fl">0.7</span>, linewidth<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">'steelblue'</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>ax1.axhline(y<span class="op">=</span>greedy_cost, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f'Greedy: €</span><span class="sc">{</span>greedy_cost<span class="op">/</span><span class="fl">1e6</span><span class="sc">:.1f}</span><span class="ss">M'</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ax1.axhline(y<span class="op">=</span>ls_cost, color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f'Local Search: €</span><span class="sc">{</span>ls_cost<span class="op">/</span><span class="fl">1e6</span><span class="sc">:.1f}</span><span class="ss">M'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ax1.axhline(y<span class="op">=</span>sa_cost, color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">1</span>, label<span class="op">=</span><span class="ss">f'SA Best: €</span><span class="sc">{</span>sa_cost<span class="op">/</span><span class="fl">1e6</span><span class="sc">:.1f}</span><span class="ss">M'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Iteration'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Cost (€)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Simulated Annealing Progress'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>ax1.legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperature and acceptance visualization</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show when SA accepted worse moves (uphill moves)</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>uphill_moves <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sa_history)) <span class="cf">if</span> sa_history[i] <span class="op">&gt;</span> sa_history[i<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>downhill_moves <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sa_history)) <span class="cf">if</span> sa_history[i] <span class="op">&lt;=</span> sa_history[i<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>ax2.scatter(downhill_moves, [sa_history[i] <span class="cf">for</span> i <span class="kw">in</span> downhill_moves],</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>           s<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="st">'Improvements'</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>ax2.scatter(uphill_moves, [sa_history[i] <span class="cf">for</span> i <span class="kw">in</span> uphill_moves],</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>           s<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Accepted Worse Moves'</span>)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Iteration'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Cost (€)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'SA Acceptance Behavior'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>ax2.legend(fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Accepted </span><span class="sc">{</span><span class="bu">len</span>(uphill_moves)<span class="sc">:,}</span><span class="ss"> worse moves (escaping local optima)"</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Made </span><span class="sc">{</span><span class="bu">len</span>(downhill_moves)<span class="sc">:,}</span><span class="ss"> improvements"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualize-sa-solution" class="level2">
<h2 class="anchored" data-anchor-id="visualize-sa-solution">Visualize SA Solution</h2>
<div id="f4e7019b" class="cell" data-execution_count="31">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">10</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get assignments for the SA solution</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>sa_assignments <span class="op">=</span> get_cafe_assignments(sa_solution, cafe_locations, potential_centers)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot connection lines first (so they appear behind markers)</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center_idx, cafe_indices <span class="kw">in</span> sa_assignments.items():</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    center_loc <span class="op">=</span> potential_centers[center_idx]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> cafe_idx <span class="kw">in</span> cafe_indices:</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        cafe_loc <span class="op">=</span> cafe_locations[cafe_idx]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>        plt.plot([center_loc[<span class="dv">1</span>], cafe_loc[<span class="dv">1</span>]], [center_loc[<span class="dv">0</span>], cafe_loc[<span class="dv">0</span>]], </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'gold'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, zorder<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all locations        </span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>plt.scatter(center_lons, center_lats, s<span class="op">=</span><span class="dv">80</span>, alpha<span class="op">=</span><span class="fl">0.1</span>, color<span class="op">=</span><span class="st">'red'</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'s'</span>, label<span class="op">=</span><span class="st">'Potential Centers (200)'</span>, edgecolors<span class="op">=</span><span class="st">'darkred'</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all cafés</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>plt.scatter(cafe_lons, cafe_lats, s<span class="op">=</span><span class="dv">8</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'steelblue'</span>, </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="st">'Cafés'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot selected centers</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>selected_lats <span class="op">=</span> [potential_centers[i][<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> sa_solution]</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>selected_lons <span class="op">=</span> [potential_centers[i][<span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> sa_solution]</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>plt.scatter(selected_lons, selected_lats, s<span class="op">=</span><span class="dv">150</span>, alpha<span class="op">=</span><span class="fl">1.0</span>, color<span class="op">=</span><span class="st">'gold'</span>,</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>           marker<span class="op">=</span><span class="st">'*'</span>, label<span class="op">=</span><span class="st">'SA Selected (50)'</span>, edgecolors<span class="op">=</span><span class="st">'black'</span>, </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>           linewidth<span class="op">=</span><span class="dv">1</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude (°)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f'Simulated Annealing Solution: €</span><span class="sc">{</span>sa_cost<span class="sc">:,.0f}</span><span class="ss">/year (</span><span class="sc">{</span>sa_improvement_pct<span class="sc">:.1f}</span><span class="ss">% improvement)</span><span class="ch">\n</span><span class="ss">(Escaped local optima through controlled exploration)'</span>,</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>         fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Notice how SA found a different configuration than Local Search!"</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"By accepting temporary worse moves, SA explored more of the solution space"</span>)</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"This allowed it to escape local optima and find a better global solution"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Why SA beats Local Search:</strong></p>
<ul>
<li><strong>Early exploration</strong> (high T): SA accepts worse moves, exploring far from greedy solution</li>
<li><strong>Strategic descent</strong> (mid T): SA occasionally climbs small hills to find better valleys</li>
<li><strong>Fine-tuning</strong> (low T): SA behaves like local search to polish the solution</li>
</ul>
<p>The key: <strong>temporary bad decisions enable better long-term outcomes!</strong></p>
</section>
</section>
<section id="section-5-ceo-decision-framework-competition-connection" class="level1">
<h1>Section 5: CEO Decision Framework &amp; Competition Connection</h1>
<section id="the-business-case" class="level2">
<h2 class="anchored" data-anchor-id="the-business-case">The Business Case</h2>
<p>Let’s calculate the real financial impact, based on your results. Just execute the following code block:</p>
<div id="5626529f" class="cell" data-execution_count="32">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Algorithm'</span>: [<span class="st">'Current (Random)'</span>, <span class="st">'Greedy'</span>, <span class="st">'Local Search'</span>, <span class="st">'Simulated Annealing'</span>],</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Annual Cost (€)'</span>: [baseline_random_cost, greedy_cost, ls_cost, sa_cost],</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Annual Savings (€)'</span>: [</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        baseline_random_cost <span class="op">-</span> greedy_cost,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        baseline_random_cost <span class="op">-</span> ls_cost,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        baseline_random_cost <span class="op">-</span> sa_cost</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Improvement (%)'</span>: [</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        <span class="dv">0</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        ((baseline_random_cost <span class="op">-</span> greedy_cost) <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        ((baseline_random_cost <span class="op">-</span> ls_cost) <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>        ((baseline_random_cost <span class="op">-</span> sa_cost) <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BEAN COUNTER DISTRIBUTION NETWORK OPTIMIZATION - EXECUTIVE SUMMARY"</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-year contract value</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>best_savings_annual <span class="op">=</span> baseline_random_cost <span class="op">-</span> sa_cost</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>best_savings_10year <span class="op">=</span> best_savings_annual <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">RECOMMENDED SOLUTION: Simulated Annealing"</span>)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Annual savings: €</span><span class="sc">{</span>best_savings_annual<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   10-year contract savings: €</span><span class="sc">{</span>best_savings_10year<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   ROI on optimization effort: &gt;</span><span class="sc">{</span>best_savings_10year <span class="op">/</span> <span class="dv">100_000</span><span class="sc">:.0f}</span><span class="ss">x"</span>)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>improvement_achieved <span class="op">=</span> ((baseline_random_cost <span class="op">-</span> sa_cost) <span class="op">/</span> baseline_random_cost) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Board target: 20% reduction → ACHIEVED </span><span class="sc">{</span>improvement_achieved<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">80</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p><strong>Congratulations, CEO!</strong> You’ve mastered metaheuristics and saved Bean Counter millions! Your empire is now more efficient and profitable than ever before, thanks to your knowledge in management science. Your leadership has enabled Bean Counter to thrive in a competitive market, and has set the stage for even greater success!</p>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">What’s Next?</h2>
<p>In the <strong>Restaurant Staffing Competition</strong>, you’ll:</p>
<ul>
<li>Apply these algorithms to the scheduling problem</li>
<li>Optimize labor costs while meeting service requirements</li>
<li>Use SA to find the best schedule</li>
<li>Visualize and present your solution strategy</li>
</ul>
<p><strong>You’re ready! Go optimize that restaurant!</strong></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/beyondsimulations\.github\.io\/Management-Science");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/beyondsimulations/Management-Science">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/tobiasvlcek">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:vlcek@beyondsimulations.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://beyondsimulations.github.io/lectures">
      <i class="bi bi-skip-backward" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../general/privacy.html">
<p>Privacy Policy</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
<p>Management Science, Tobias Vlćek <br>CC BY-NC-SA 4.0</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script src="https://cdn.jsdelivr.net/gh/beyondsimulations/web-embedded-chat@latest/floating-chat.js"></script>
<script>
    new UniversalChatWidget({
        title: "Course Assistant",
        apiEndpoint: "https://model-proxy.vlcek-4b4.workers.dev/api",
        model: "management-science",
        userMessageOpacity: 0.5,
        assistantMessageOpacity: 0.5,
        position: "bottom-right",
        windowHeight: 800
    });
</script>




</body></html>